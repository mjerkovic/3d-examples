<html>
	<head>
		<script src="lib/three.min.js"></script>
		<script src="lib/controls.js"></script>
		<script src="lib/physi.js"></script>
		<script src="lib/physijs_worker.js"></script>
		<script src="scene.js"></script>
		<script>
		    var camera, scene, renderer, compass, forward, controls;

		   	function setup() {
			    init();
			    animate();
		   	}

		    function init() {
		    	Physijs.scripts.worker = 'lib/physijs_worker.js';
				Physijs.scripts.ammo = 'ammo.js';

		        camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 500 );
		        camera.position.set(0, 2, 30);
    			camera.lookAt(new THREE.Vector3(0, 4, 0));

    			controls = new FirstPersonControls(camera);
    			controls.target = new THREE.Vector3(0, 4, 0);
    			controls.movementSpeed = 2;
    			controls.noFly = true;
    			controls.lookVertical = false;

                scene = initScene();

                renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize( window.innerWidth, window.innerHeight );
                renderer.setClearColor(0xDEDEDE);
                document.body.appendChild( renderer.domElement );
            }

		    function animate() {
				scene.simulate();
		        //compass.translate.y -= compass.position.y;
		        //compass.rotation.x += 0.01;
		        //compass.rotation.y += 0.01;
/*		        if (forward) {
		        	camera.position.z -= 0.3;
		        }
*/
				controls.update(0.1);
		        renderer.render( scene, camera );
		        // note: three.js includes requestAnimationFrame shim
		        requestAnimationFrame( animate );
		    }
		</script>
	</head>
	<body onload="setup()">
	</body>		
</html>
